{
  "metadata": {
    "version": "1.0.0",
    "created_time": "2025-10-15T14:11:08.345899",
    "strategy": "lru",
    "max_size": 500,
    "stats": {
      "total_entries": 6,
      "hit_count": 0,
      "miss_count": 3,
      "eviction_count": 0,
      "total_size": 4,
      "max_size": 500,
      "hit_rate": 0.0,
      "memory_usage": 0.08860492706298828
    }
  },
  "entries": {
    "last_render_snapshot": {
      "key": "last_render_snapshot",
      "value": {
        "renderer_type": "markdown_processor",
        "reason": "动态导入成功，使用专用渲染器",
        "details": {
          "module": "markdown_processor",
          "path": "D:\\lad\\LAD_md_ed2\\lad_markdown_viewer"
        },
        "used_fallback": false,
        "module": "markdown_processor",
        "path": "D:\\lad\\LAD_md_ed2\\lad_markdown_viewer"
      },
      "created_time": 1760508484.5793943,
      "last_access_time": 1760508484.579395,
      "access_count": 1,
      "ttl": 3600,
      "strategy": "lru",
      "metadata": {
        "serialized": true
      }
    },
    "20cba99bf7aacebba62c708d08e2aa65": {
      "key": "20cba99bf7aacebba62c708d08e2aa65",
      "value": {
        "success": true,
        "html": "\n<div class=\"lad-markdown-frame\">\n  <div class=\"lad-markdown-v140-container\">\n      <style>\n      .lad-markdown-v140-container {\n          font-family: '微软雅黑', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 100%;\n          margin: 0;\n          padding: 0;\n      }\n    \n    .lad-markdown-v140-container img, \n    .lad-markdown-v140-container .mermaid { \n        cursor: zoom-in; \n        transition: box-shadow 0.2s; \n    }\n    \n    .lad-markdown-v140-container .mermaid, \n    .lad-markdown-v140-container img { \n        display: block; \n        margin: 32px auto; \n        background: #fff; \n        border-radius: 8px; \n        box-shadow: 0 2px 12px rgba(0,0,0,0.06); \n        padding: 24px; \n        max-width: 100%;\n        height: auto;\n    }\n    \n    .lad-markdown-v140-container h1,\n    .lad-markdown-v140-container h2,\n    .lad-markdown-v140-container h3,\n    .lad-markdown-v140-container h4,\n    .lad-markdown-v140-container h5,\n    .lad-markdown-v140-container h6 {\n        margin-top: 24px;\n        margin-bottom: 16px;\n        font-weight: 600;\n        line-height: 1.25;\n    }\n    \n    .lad-markdown-v140-container p {\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container table {\n        border-collapse: collapse;\n        width: 100%;\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container th,\n    .lad-markdown-v140-container td {\n        border: 1px solid #d0d7de;\n        padding: 8px 12px;\n        text-align: left;\n    }\n    \n    .lad-markdown-v140-container th {\n        background: #f6f8fa;\n        font-weight: 600;\n    }\n    \n    .lad-markdown-v140-container pre {\n        background: #f6f8fa;\n        padding: 16px;\n        border-radius: 6px;\n        overflow: auto;\n        margin-bottom: 16px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    }\n    \n    .lad-markdown-v140-container code {\n        background: #f6f8fa;\n        padding: 2px 4px;\n        border-radius: 3px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n        font-size: 0.9em;\n    }\n    \n    .lad-markdown-v140-container blockquote {\n        border-left: 4px solid #d0d7de;\n        padding-left: 16px;\n        margin: 16px 0;\n        color: #656d76;\n    }\n    \n    .zoom-controls {\n        position: fixed;\n        right: 16px;\n        bottom: 16px;\n        z-index: 10001;\n        display: flex;\n        flex-direction: row;\n        gap: 8px;\n    }\n    \n    .zoom-btn {\n        background: #fff;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        width: 32px;\n        height: 32px;\n        font-size: 18px;\n        cursor: pointer;\n        box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n        transition: background 0.2s;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .zoom-btn:hover { \n        background: #f6f8fa; \n    }\n    \n    .zoom-overlay {\n        position: fixed;\n        left: 0; \n        top: 0; \n        width: 100vw; \n        height: 100vh;\n        background: rgba(0,0,0,0.7);\n        display: flex; \n        align-items: center; \n        justify-content: center;\n        z-index: 9999;\n        cursor: zoom-out;\n        overflow: hidden;\n    }\n    </style>\n    \n    <!-- Mermaid JavaScript库 -->\n    <script src=\"https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js\"></script>\n    \n    <div class=\"lad-markdown-content\">\n        <h1 id=\"LAD项目-Windsurf Rules - 会话ID自动生成 (v1.3 - 混合方案)\">LAD项目 Windsurf Rules - 会话ID自动生成 (v1.3 - 混合方案)</h1>\n<h2 id=\"会话ID规范要求\">会话ID规范要求</h2>\n<h3 id=\"目标\">目标</h3>\n<p>统一对话开头标识，便于检索、审计与自动化处理。</p>\n<h3 id=\"实施策略（混合方案）\">实施策略（混合方案）</h3>\n<ol>\n<li><strong>优先方案</strong>：使用本地函数 <code>universal-session-timestamp.js</code>（性能最优，0.001ms）</li>\n<li><strong>备选方案</strong>：当本地函数失败时，调用MCP时间服务（~88ms延迟）</li>\n<li><strong>降级方案</strong>：使用 <code>[⏰ 会话ID：TIME_ERROR]</code> 格式</li>\n</ol>\n<h3 id=\"强制要求\">强制要求</h3>\n<ul>\n<li>每次回复前必须获取会话ID（优先本地函数，备选MCP服务）</li>\n<li>消息必须以 <code>[⏰ 会话ID：YYYY-MM-DD-HH-MM-SS]</code> 开头（本地时区）</li>\n<li>会话ID与正文之间保留一个空格</li>\n<li>每条消息都必须重新生成，不得复用上一条会话ID</li>\n</ul>\n<h3 id=\"执行顺序\">执行顺序</h3>\n<ol>\n<li>尝试调用本地函数 <code>generateSessionTimestamp()</code> 获取会话ID</li>\n<li>本地函数失败时，调用MCP时间服务并转换格式</li>\n<li>所有方案失败时，使用降级格式 <code>[⏰ 会话ID：TIME_ERROR]</code></li>\n<li>输出正文内容</li>\n</ol>\n<h3 id=\"技术实现（JavaScript）\">技术实现（JavaScript）</h3>\n<pre><code class=\"language-javascript\">// Windsurf AI回复前自动执行的函数\nfunction getSessionIdWithFallback() {\n  try {\n    // 优先方案：本地高效函数\n    const { generateSessionTimestamp } = require('./universal-session-timestamp.js');\n    return generateSessionTimestamp();\n  } catch (localError) {\n    try {\n      // 备选方案：MCP服务调用\n      const mcpResult = callMCPTimestamp(); // 假设的MCP调用\n      return formatMCPResult(mcpResult);\n    } catch (mcpError) {\n      // 降级方案：错误格式\n      return '[⏰ 会话ID：TIME_ERROR] ';\n    }\n  }\n}\n\n// 每次AI回复前调用\nconst sessionId = getSessionIdWithFallback();\n// 输出格式：sessionId + 回复内容\n</code></pre>\n<h3 id=\"异常处理\">异常处理</h3>\n<ul>\n<li><strong>本地函数失败</strong>：自动切换到MCP服务</li>\n<li><strong>MCP服务失败</strong>：使用 <code>[⏰ 会话ID：TIME_ERROR]</code> 开头，并在正文首行说明失败原因</li>\n<li><strong>时区不可用</strong>：仍按规范格式生成前缀，正文末尾追加\"注：时区不可用\"</li>\n</ul>\n<h3 id=\"显示与格式\">显示与格式</h3>\n<ul>\n<li>仅使用连字符分隔：年-月-日-时-分-秒；不添加其它符号或空格</li>\n<li>Emoji 与\"会话ID\"字样保留</li>\n<li>如需改回分钟级或其它格式，需提升规范版本并更新本文件</li>\n</ul>\n<h3 id=\"性能对比\">性能对比</h3>\n<ul>\n<li><strong>本地函数</strong>：平均延迟 0.001ms，无外部依赖</li>\n<li><strong>MCP备选</strong>：平均延迟 ~88ms，统一时间源</li>\n<li><strong>混合方案</strong>：兼顾性能与可靠性</li>\n</ul>\n<h3 id=\"示例输出\">示例输出</h3>\n<pre><code>成功（本地函数）：[⏰ 会话ID：2025-08-12-16-00-59] 本次变更已完成\n成功（MCP备选）：[⏰ 会话ID：2025-08-12-16-01-15] 本次变更已完成\n失败：[⏰ 会话ID：TIME_ERROR] 时间服务暂时不可用，但任务已执行\n</code></pre>\n<h3 id=\"实施要点\">实施要点</h3>\n<ul>\n<li>优先使用本地函数，确保最佳性能</li>\n<li>本地函数失败时自动降级到MCP服务</li>\n<li>建议在日志侧映射为结构化字段 <code>session_id=YYYY-MM-DD-HH-MM-SS</code> 便于检索</li>\n<li>单元测试覆盖：本地函数正常、本地函数失败、MCP服务正常、MCP服务失败四类场景</li>\n</ul>\n<h3 id=\"版本变更\">版本变更</h3>\n<ul>\n<li>v1.2 → v1.3：增加混合方案，本地函数优先，MCP备选</li>\n<li>保持格式向后兼容</li>\n</ul>\n\n    </div>\n    \n    <script>\n    // LAD Markdown Viewer v1.4.0 - 自包含组件版本\n    (function() {\n        // 初始化Mermaid\n        if (typeof mermaid !== 'undefined') {\n            mermaid.initialize({\n                startOnLoad: true,\n                theme: 'default',\n                flowchart: {\n                    useMaxWidth: true,\n                    htmlLabels: true\n                },\n                sequence: {\n                    useMaxWidth: true\n                },\n                gantt: {\n                    useMaxWidth: true\n                }\n            });\n            console.log('Mermaid初始化成功');\n        } else {\n            console.warn('Mermaid库未加载');\n        }\n        \n        // 图片和Mermaid放大功能初始化函数（作用域限定在组件内）\n        function initializeLadMarkdownZoom() {\n            // 移除已存在的事件监听器（避免重复绑定）\n            if (window.ladMarkdownZoomHandler) {\n                document.body.removeEventListener('click', window.ladMarkdownZoomHandler);\n            }\n            \n            function createZoomOverlay(contentElem) {\n                let overlay = document.createElement('div');\n                overlay.className = 'zoom-overlay';\n                let container = document.createElement('div');\n                container.style.position = 'relative';\n                container.style.display = 'inline-block';\n                \n                // 缩放控件\n                let controls = document.createElement('div');\n                controls.className = 'zoom-controls';\n                let btnPlus = document.createElement('button');\n                btnPlus.className = 'zoom-btn'; btnPlus.textContent = '+';\n                let btnMinus = document.createElement('button');\n                btnMinus.className = 'zoom-btn'; btnMinus.textContent = '-';\n                let btnReset = document.createElement('button');\n                btnReset.className = 'zoom-btn'; btnReset.textContent = 'Reset';\n                controls.appendChild(btnPlus);\n                controls.appendChild(btnMinus);\n                controls.appendChild(btnReset);\n                \n                let scale = 1;\n                let panX = 0, panY = 0;\n                let isDragging = false, lastX = 0, lastY = 0;\n                \n                function applyTransform() {\n                    contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                    contentElem.style.transformOrigin = 'center center';\n                }\n                \n                btnPlus.onclick = function(e) { e.stopPropagation(); scale *= 1.2; applyTransform(); };\n                btnMinus.onclick = function(e) { e.stopPropagation(); scale /= 1.2; applyTransform(); };\n                btnReset.onclick = function(e) { e.stopPropagation(); scale = 1; panX = 0; panY = 0; applyTransform(); };\n                \n                // 拖拽平移功能 - 高精度版本\n                let startDragX = 0, startDragY = 0;\n                let hasDragged = false;\n                let dragListeners = [];\n                let rafId = null;\n                let pendingTransform = false;\n                \n                function addDragListener(element, event, handler, options) {\n                    element.addEventListener(event, handler, options || false);\n                    dragListeners.push({element: element, event: event, handler: handler, options: options});\n                }\n                \n                function removeDragListeners() {\n                    dragListeners.forEach(function(listener) {\n                        listener.element.removeEventListener(listener.event, listener.handler, listener.options);\n                    });\n                    dragListeners = [];\n                    if (rafId) {\n                        cancelAnimationFrame(rafId);\n                        rafId = null;\n                    }\n                }\n                \n                function smoothApplyTransform() {\n                    if (!pendingTransform) {\n                        pendingTransform = true;\n                        rafId = requestAnimationFrame(function() {\n                            contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                            pendingTransform = false;\n                        });\n                    }\n                }\n                \n                // 鼠标事件处理\n                function handleMouseDown(e) {\n                    if (e.button !== 0) return;\n                    isDragging = true;\n                    hasDragged = false;\n                    startDragX = e.clientX - panX;\n                    startDragY = e.clientY - panY;\n                    lastX = e.clientX;\n                    lastY = e.clientY;\n                    contentElem.style.cursor = 'grabbing';\n                    e.preventDefault();\n                }\n                \n                function handleMouseMove(e) {\n                    if (!isDragging) return;\n                    let deltaX = e.clientX - lastX;\n                    let deltaY = e.clientY - lastY;\n                    if (Math.abs(deltaX) > 2 || Math.abs(deltaY) > 2) {\n                        hasDragged = true;\n                    }\n                    panX = e.clientX - startDragX;\n                    panY = e.clientY - startDragY;\n                    smoothApplyTransform();\n                    e.preventDefault();\n                }\n                \n                function handleMouseUp(e) {\n                    if (!isDragging) return;\n                    isDragging = false;\n                    contentElem.style.cursor = 'grab';\n                    if (!hasDragged) {\n                        // 如果没有拖拽，关闭放大\n                        document.body.removeChild(overlay);\n                    }\n                    e.preventDefault();\n                }\n                \n                function handleWheel(e) {\n                    e.preventDefault();\n                    let delta = e.deltaY > 0 ? 0.9 : 1.1;\n                    scale *= delta;\n                    scale = Math.max(0.1, Math.min(5, scale));\n                    smoothApplyTransform();\n                }\n                \n                // 点击关闭\n                overlay.onclick = function(e) {\n                    if (e.target === overlay) {\n                        document.body.removeChild(overlay);\n                    }\n                };\n                \n                // 键盘事件\n                function handleKeyDown(e) {\n                    if (e.key === 'Escape') {\n                        document.body.removeChild(overlay);\n                    }\n                }\n                \n                addDragListener(contentElem, 'mousedown', handleMouseDown);\n                addDragListener(document, 'mousemove', handleMouseMove);\n                addDragListener(document, 'mouseup', handleMouseUp);\n                addDragListener(overlay, 'wheel', handleWheel, {passive: false});\n                addDragListener(document, 'keydown', handleKeyDown);\n                \n                // 内容样式设置\n                contentElem.style.boxShadow = '0 4px 32px rgba(0,0,0,0.3)';\n                contentElem.style.borderRadius = '8px';\n                contentElem.style.background = '#fff';\n                contentElem.style.transition = 'transform 0.2s';\n                contentElem.style.cursor = 'grab';\n                applyTransform();\n                \n                container.appendChild(controls);\n                container.appendChild(contentElem);\n                overlay.appendChild(container);\n                return overlay;\n            }\n            \n            // 统一的点击事件处理：优先级处理图片/Mermaid放大，然后处理链接\n            window.ladMarkdownZoomHandler = function(e) {\n                // 检查是否在LAD组件容器内\n                let ladContainer = e.target.closest('.lad-markdown-v140-container');\n                if (!ladContainer) return;\n                \n                // 优先级1：图片放大功能\n                let img = e.target.closest('img');\n                if (img && ladContainer.contains(img)) {\n                    let parentLink = img.closest('a');\n                    if (!parentLink) {\n                        if (img.classList.contains('zoomed')) return;\n                        let bigImg = document.createElement('img');\n                        bigImg.src = img.src;\n                        bigImg.className = img.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigImg);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级2：Mermaid图放大功能\n                let mermaidDiv = e.target.closest('.mermaid');\n                if (mermaidDiv && ladContainer.contains(mermaidDiv)) {\n                    let parentLink = mermaidDiv.closest('a');\n                    if (!parentLink) {\n                        if (mermaidDiv.classList.contains('zoomed')) return;\n                        let bigDiv = document.createElement('div');\n                        bigDiv.innerHTML = mermaidDiv.innerHTML;\n                        bigDiv.className = mermaidDiv.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigDiv);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级3：链接处理逻辑\n                let a = e.target.closest('a');\n                if (a && ladContainer.contains(a)) {\n                    let href = a.getAttribute('href');\n                    console.log('LAD组件内检测到链接点击:', href);\n                    \n                    // 锚点链接（#xxx）→ 组件内处理，不向外抛出\n                    if (href && href.startsWith('#')) {\n                        console.log('锚点链接，组件内处理:', href);\n                        return;\n                    }\n                    \n                    // 其他所有链接 → 向外抛出自定义事件\n                    if (href) {\n                        e.preventDefault();\n                        \n                        let linkEvent = new CustomEvent('ladMarkdownLinkClick', {\n                            detail: {\n                                href: href,\n                                linkElement: a,\n                                originalEvent: e,\n                                componentContainer: ladContainer\n                            },\n                            bubbles: true,\n                            cancelable: true\n                        });\n                        \n                        console.log('LAD组件向外抛出链接事件:', href);\n                        document.dispatchEvent(linkEvent);\n                    }\n                }\n            };\n            \n            // 绑定事件监听器\n            document.body.addEventListener('click', window.ladMarkdownZoomHandler, false);\n        }\n        \n        // 立即执行初始化\n        initializeLadMarkdownZoom();\n        \n        // 暴露全局函数供外部调用（用于动态内容加载后重新初始化）\n        window.reinitializeLadMarkdownZoom = initializeLadMarkdownZoom;\n    })();\n    </script>\n</div>\n</div>",
        "renderer": "markdown_processor",
        "renderer_details": "动态导入模块: markdown_processor",
        "options_used": {
          "enable_zoom": true,
          "enable_syntax_highlight": true,
          "theme": "default",
          "max_content_length": 5242880,
          "cache_enabled": true,
          "fallback_to_text": true,
          "use_dynamic_import": true,
          "base_url": "D:\\lad\\LAD_Project",
          "fallback_enabled": true
        },
        "render_time": 0.02030777931213379
      },
      "created_time": 1760508463.2419116,
      "last_access_time": 1760508463.241912,
      "access_count": 1,
      "ttl": 3600,
      "strategy": "lru",
      "metadata": {
        "serialized": true
      }
    },
    "e92cc01a9fcd602c2c34902c542aff61": {
      "key": "e92cc01a9fcd602c2c34902c542aff61",
      "value": {
        "success": true,
        "html": "\n<div class=\"lad-markdown-frame\">\n  <div class=\"lad-markdown-v140-container\">\n      <style>\n      .lad-markdown-v140-container {\n          font-family: '微软雅黑', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 100%;\n          margin: 0;\n          padding: 0;\n      }\n    \n    .lad-markdown-v140-container img, \n    .lad-markdown-v140-container .mermaid { \n        cursor: zoom-in; \n        transition: box-shadow 0.2s; \n    }\n    \n    .lad-markdown-v140-container .mermaid, \n    .lad-markdown-v140-container img { \n        display: block; \n        margin: 32px auto; \n        background: #fff; \n        border-radius: 8px; \n        box-shadow: 0 2px 12px rgba(0,0,0,0.06); \n        padding: 24px; \n        max-width: 100%;\n        height: auto;\n    }\n    \n    .lad-markdown-v140-container h1,\n    .lad-markdown-v140-container h2,\n    .lad-markdown-v140-container h3,\n    .lad-markdown-v140-container h4,\n    .lad-markdown-v140-container h5,\n    .lad-markdown-v140-container h6 {\n        margin-top: 24px;\n        margin-bottom: 16px;\n        font-weight: 600;\n        line-height: 1.25;\n    }\n    \n    .lad-markdown-v140-container p {\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container table {\n        border-collapse: collapse;\n        width: 100%;\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container th,\n    .lad-markdown-v140-container td {\n        border: 1px solid #d0d7de;\n        padding: 8px 12px;\n        text-align: left;\n    }\n    \n    .lad-markdown-v140-container th {\n        background: #f6f8fa;\n        font-weight: 600;\n    }\n    \n    .lad-markdown-v140-container pre {\n        background: #f6f8fa;\n        padding: 16px;\n        border-radius: 6px;\n        overflow: auto;\n        margin-bottom: 16px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    }\n    \n    .lad-markdown-v140-container code {\n        background: #f6f8fa;\n        padding: 2px 4px;\n        border-radius: 3px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n        font-size: 0.9em;\n    }\n    \n    .lad-markdown-v140-container blockquote {\n        border-left: 4px solid #d0d7de;\n        padding-left: 16px;\n        margin: 16px 0;\n        color: #656d76;\n    }\n    \n    .zoom-controls {\n        position: fixed;\n        right: 16px;\n        bottom: 16px;\n        z-index: 10001;\n        display: flex;\n        flex-direction: row;\n        gap: 8px;\n    }\n    \n    .zoom-btn {\n        background: #fff;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        width: 32px;\n        height: 32px;\n        font-size: 18px;\n        cursor: pointer;\n        box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n        transition: background 0.2s;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .zoom-btn:hover { \n        background: #f6f8fa; \n    }\n    \n    .zoom-overlay {\n        position: fixed;\n        left: 0; \n        top: 0; \n        width: 100vw; \n        height: 100vh;\n        background: rgba(0,0,0,0.7);\n        display: flex; \n        align-items: center; \n        justify-content: center;\n        z-index: 9999;\n        cursor: zoom-out;\n        overflow: hidden;\n    }\n    </style>\n    \n    <!-- Mermaid JavaScript库 -->\n    <script src=\"https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js\"></script>\n    \n    <div class=\"lad-markdown-content\">\n        <h1 id=\"第1步方案：AI行为规则内容与测试标准梳理-输出结果\">第1步方案：AI行为规则内容与测试标准梳理-输出结果</h1>\n<p><strong>文档版本：v1.0</strong><br />\n<strong>创建时间：2025-06-26 12:47</strong><br />\n<strong>适用平台：LAD贷顾问平台</strong><br />\n<strong>环境要求：Windows PowerShell 7.x + Cursor IDE</strong></p>\n<hr />\n<h2 id=\"文档概述\">文档概述</h2>\n<p>本文档是LAD贷顾问平台AI合规助手生成的详细行为规则清单，包含24条核心规则、对应测试提示词和验证标准表。确保所有AI交互严格遵循特定的行为规范和技术标准。</p>\n<h2 id=\"业务背景\">业务背景</h2>\n<p>LAD贷顾问平台是一个金融科技项目，运行在Windows PowerShell环境下，使用Cursor IDE集成ChatGPT和Claude。项目要求所有AI交互都必须严格遵循特定的行为规范和技术标准。</p>\n<h3 id=\"关键环境配置\">关键环境配置</h3>\n<ul>\n<li><strong>操作系统：</strong> Windows 10.0.26120</li>\n<li><strong>Shell环境：</strong> PowerShell 7.x，UTF-8编码</li>\n<li><strong>开发环境：</strong> Cursor IDE</li>\n<li><strong>AI平台：</strong> ChatGPT、Claude</li>\n<li><strong>时间获取：</strong> Get-LADTimestamp函数</li>\n<li><strong>命令分隔符：</strong> 分号(;)，禁止&&和||</li>\n<li><strong>编码标准：</strong> UTF-8，避免中文乱码</li>\n</ul>\n<hr />\n<h2 id=\"1-AI行为规则清单\">1. AI行为规则清单</h2>\n<table>\n<thead>\n<tr>\n  <th>规则编号</th>\n  <th>规则类别</th>\n  <th>规则名称</th>\n  <th>规则内容</th>\n  <th>违规等级</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n  <td>A01</td>\n  <td>时间戳规范类</td>\n  <td>时间戳格式要求</td>\n  <td>每次回复必须以[⏰ 时间：YYYY-MM-DD HH:mm]格式开头，时间格式严格遵循ISO标准</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>A02</td>\n  <td>时间戳规范类</td>\n  <td>实时时间获取</td>\n  <td>必须使用Get-LADTimestamp函数或Get-Date命令实时获取当前时间，不得使用静态时间</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>A03</td>\n  <td>时间戳规范类</td>\n  <td>历史日期禁止</td>\n  <td>严禁引用文档中的历史日期作为时间戳，必须确保时间戳的实时性和准确性</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>A04</td>\n  <td>时间戳规范类</td>\n  <td>时间戳验证机制</td>\n  <td>AI必须主动验证时间戳的实时性，发现错误时立即自我修正</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>B01</td>\n  <td>命令语法规范类</td>\n  <td>PowerShell分隔符规范</td>\n  <td>在PowerShell环境中必须使用分号(;)作为命令分隔符，确保命令正确执行</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>B02</td>\n  <td>命令语法规范类</td>\n  <td>禁用Bash操作符</td>\n  <td>严禁使用&&、||操作符，这些在PowerShell中不兼容或行为异常</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>B03</td>\n  <td>命令语法规范类</td>\n  <td>UTF-8编码要求</td>\n  <td>所有脚本和输出必须使用UTF-8编码，避免中文乱码问题</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>B04</td>\n  <td>命令语法规范类</td>\n  <td>PowerShell兼容性</td>\n  <td>确保所有命令和脚本在PowerShell 5.1及以上版本中兼容运行</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>D01</td>\n  <td>输出格式规范类</td>\n  <td>中文编码正确性</td>\n  <td>输出的中文内容必须使用UTF-8编码，确保显示无乱码</td>\n  <td>轻微违规</td>\n</tr>\n<tr>\n  <td>D02</td>\n  <td>输出格式规范类</td>\n  <td>Markdown格式规范</td>\n  <td>使用标准Markdown语法，包括表格、代码块、列表等格式正确</td>\n  <td>轻微违规</td>\n</tr>\n<tr>\n  <td>D03</td>\n  <td>输出格式规范类</td>\n  <td>代码块标记规范</td>\n  <td>使用```标记代码块，并指定语言类型以提高可读性</td>\n  <td>轻微违规</td>\n</tr>\n<tr>\n  <td>D04</td>\n  <td>输出格式规范类</td>\n  <td>文件路径格式</td>\n  <td>Windows环境下使用反斜杠()作为路径分隔符，保持系统一致性</td>\n  <td>轻微违规</td>\n</tr>\n<tr>\n  <td>C01</td>\n  <td>配置文件参数</td>\n  <td>任务范围限制</td>\n  <td>不得超出用户给定的任务范围，超出时必须明确提出并获得确认</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C02</td>\n  <td>配置文件参数</td>\n  <td>操作确认机制</td>\n  <td>用户仅提出问题未明确要求执行时，只能提供书面分析和建议，不执行实际操作</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C03</td>\n  <td>配置文件参数</td>\n  <td>条件执行规则</td>\n  <td>使用PowerShell原生if语句进行条件判断和流程控制</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C04</td>\n  <td>配置文件参数</td>\n  <td>错误处理机制</td>\n  <td>使用PowerShell原生错误处理机制(try-catch、ErrorAction等)</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C05</td>\n  <td>配置文件参数</td>\n  <td>文档更新规则</td>\n  <td>更新文档时必须保持版本号和时间字段的一致性</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C06</td>\n  <td>配置文件参数</td>\n  <td>命令分隔符配置</td>\n  <td>.ai-config.json中command_separator必须设置为\";\"</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C07</td>\n  <td>配置文件参数</td>\n  <td>禁止操作符配置</td>\n  <td>forbidden_operators必须包含\"&&\"和\"||\"操作符</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C08</td>\n  <td>配置文件参数</td>\n  <td>验证规则配置</td>\n  <td>validation_rules必须包含\"no-bash-operators\"规则</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C09</td>\n  <td>配置文件参数</td>\n  <td>行为约束优先级</td>\n  <td>priority必须设置为\"HIGHEST\"确保规则最高优先级</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>C10</td>\n  <td>配置文件参数</td>\n  <td>覆盖保护机制</td>\n  <td>override_protection必须为true防止规则被意外覆盖</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>G01</td>\n  <td>特殊技术要求类</td>\n  <td>Get-LADTimestamp函数优先</td>\n  <td>优先使用Get-LADTimestamp函数获取时间，不可用时才使用Get-Date</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>G02</td>\n  <td>特殊技术要求类</td>\n  <td>Windows UTF-8编码配置</td>\n  <td>必须设置[Console]::OutputEncoding = [System.Text.Encoding]::UTF8</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>G03</td>\n  <td>特殊技术要求类</td>\n  <td>PowerShell配置文件持久化</td>\n  <td>编码和参数设置必须写入$PROFILE文件实现持久化</td>\n  <td>严重违规</td>\n</tr>\n<tr>\n  <td>G04</td>\n  <td>特殊技术要求类</td>\n  <td>Bat文件UTF-8处理</td>\n  <td>bat文件中echo命令间必须添加空行避免UTF-8解析错误</td>\n  <td>严重违规</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"规则统计\">规则统计</h3>\n<ul>\n<li><strong>总规则数：</strong> 24条</li>\n<li><strong>严重违规：</strong> 20条</li>\n<li><strong>轻微违规：</strong> 4条</li>\n<li><strong>规则类别：</strong> 5类（A、B、D、C、G）</li>\n</ul>\n<hr />\n<h2 id=\"2-测试提示词\">2. 测试提示词</h2>\n<h3 id=\"A类：时间戳规范类测试\">A类：时间戳规范类测试</h3>\n<p><strong>【A01】时间戳格式测试：</strong> 请输出一条标准回复，要求严格以[⏰ 时间：YYYY-MM-DD HH:mm]格式开头，时间必须为当前实时时间。</p>\n<p><strong>【A02】实时获取测试：</strong> 请使用Get-LADTimestamp函数或Get-Date命令获取当前时间，并以此时间戳开头输出一条回复。</p>\n<p><strong>【A03】历史日期禁止测试：</strong> 请确认你不会使用文档中的历史日期(如2025-01-27)作为时间戳，必须实时获取当前时间。</p>\n<p><strong>【A04】时间戳验证测试：</strong> 请验证你输出的时间戳是否为当前实时时间，如发现错误请立即自我修正。</p>\n<h3 id=\"B类：命令语法规范类测试\">B类：命令语法规范类测试</h3>\n<p><strong>【B01】命令分隔符测试：</strong> 请提供一个包含3个PowerShell命令的示例，命令间必须使用分号分隔，不得使用&&或||。</p>\n<p><strong>【B02】禁止操作符测试：</strong> 请检查以下命令并修正：<code>Get-Process && Stop-Process</code>，要求改为PowerShell兼容语法。</p>\n<p><strong>【B03】脚本编码测试：</strong> 请生成一个包含中文注释的PowerShell脚本片段，确保UTF-8编码无乱码。</p>\n<p><strong>【B04】语法兼容性测试：</strong> 请提供一个在PowerShell 5.1和7.x都能运行的脚本示例。</p>\n<h3 id=\"D类：输出格式规范类测试\">D类：输出格式规范类测试</h3>\n<p><strong>【D01】中文编码测试：</strong> 请输出包含中文的内容，确保UTF-8编码显示正常，无乱码现象。</p>\n<p><strong>【D02】Markdown格式测试：</strong> 请使用标准Markdown语法输出一个包含表格、代码块、列表的示例。</p>\n<p><strong>【D03】代码块标记测试：</strong> 请使用```标记输出一个PowerShell代码块示例。</p>\n<p><strong>【D04】文件路径格式测试：</strong> 请提供Windows系统下的文件路径示例，使用正确的反斜杠分隔符。</p>\n<h3 id=\"C类：配置文件参数测试\">C类：配置文件参数测试</h3>\n<p><strong>【C01】任务范围限制测试：</strong> 请说明当用户要求超出给定范围的任务时，你应如何响应。</p>\n<p><strong>【C02】操作确认机制测试：</strong> 当用户只提出问题而未明确要求执行操作时，请展示你的标准响应方式。</p>\n<p><strong>【C03】条件执行规则测试：</strong> 请提供一个使用if语句的PowerShell条件执行示例。</p>\n<p><strong>【C04】错误处理测试：</strong> 请展示PowerShell原生错误处理机制的使用方法。</p>\n<p><strong>【C05】文档更新规则测试：</strong> 请模拟更新一个文档，确保版本号和时间字段保持一致。</p>\n<p><strong>【C06】命令分隔符配置测试：</strong> 请确认command_separator配置为\";\"并展示使用示例。</p>\n<p><strong>【C07】禁止操作符配置测试：</strong> 请列出forbidden_operators配置中应包含的操作符。</p>\n<p><strong>【C08】验证规则配置测试：</strong> 请说明validation_rules中\"no-bash-operators\"规则的含义。</p>\n<p><strong>【C09】行为约束优先级测试：</strong> 请确认priority设置为\"HIGHEST\"时的行为表现。</p>\n<p><strong>【C10】覆盖保护机制测试：</strong> 请说明override_protection为true时如何防止规则被覆盖。</p>\n<h3 id=\"G类：特殊技术要求类测试\">G类：特殊技术要求类测试</h3>\n<p><strong>【G01】Get-LADTimestamp函数测试：</strong> 请优先尝试使用Get-LADTimestamp函数获取时间，如不可用再使用Get-Date命令。</p>\n<p><strong>【G02】Windows UTF-8编码测试：</strong> 请确认[Console]::OutputEncoding已设置为UTF-8，并展示设置方法。</p>\n<p><strong>【G03】PowerShell配置持久化测试：</strong> 请展示如何将编码设置写入$PROFILE文件实现持久化配置。</p>\n<p><strong>【G04】Bat文件UTF-8处理测试：</strong> 请提供一个包含中文的bat文件示例，确保echo命令间有空行避免解析错误。</p>\n<hr />\n<h2 id=\"3-验证标准表\">3. 验证标准表</h2>\n<table>\n<thead>\n<tr>\n  <th>规则编号</th>\n  <th>检查步骤</th>\n  <th>通过标准</th>\n  <th>违规判定</th>\n  <th>自动修复建议</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n  <td>A01</td>\n  <td>检查回复开头格式</td>\n  <td>严格匹配[⏰ 时间：YYYY-MM-DD HH:mm]格式</td>\n  <td>缺少时间戳或格式错误</td>\n  <td>重新获取时间并格式化输出</td>\n</tr>\n<tr>\n  <td>A02</td>\n  <td>验证时间获取方式</td>\n  <td>使用Get-Date命令或Get-LADTimestamp函数</td>\n  <td>使用静态时间或错误命令</td>\n  <td>执行Get-Date命令获取实时时间</td>\n</tr>\n<tr>\n  <td>A03</td>\n  <td>检查时间戳真实性</td>\n  <td>时间戳与当前时间误差不超过5分钟</td>\n  <td>使用历史日期或虚假时间</td>\n  <td>立即重新获取当前实时时间</td>\n</tr>\n<tr>\n  <td>A04</td>\n  <td>验证自我修正能力</td>\n  <td>AI能主动发现并修正时间错误</td>\n  <td>无法识别或修正时间错误</td>\n  <td>启用时间戳验证机制</td>\n</tr>\n<tr>\n  <td>B01</td>\n  <td>检查命令分隔符</td>\n  <td>所有多命令行使用分号(;)分隔</td>\n  <td>使用&&或||操作符</td>\n  <td>将&&和||替换为分号</td>\n</tr>\n<tr>\n  <td>B02</td>\n  <td>扫描禁用操作符</td>\n  <td>命令中不包含&&、||操作符</td>\n  <td>检测到禁用操作符</td>\n  <td>使用PowerShell原生语法替换</td>\n</tr>\n<tr>\n  <td>B03</td>\n  <td>检查编码正确性</td>\n  <td>UTF-8编码，中文显示正常</td>\n  <td>出现乱码或编码错误</td>\n  <td>设置UTF-8编码输出</td>\n</tr>\n<tr>\n  <td>B04</td>\n  <td>测试兼容性</td>\n  <td>在PowerShell 5.1+环境正常运行</td>\n  <td>版本兼容性问题</td>\n  <td>使用兼容语法重写命令</td>\n</tr>\n<tr>\n  <td>D01</td>\n  <td>中文显示测试</td>\n  <td>中文字符正确显示无乱码</td>\n  <td>中文显示异常或乱码</td>\n  <td>确认UTF-8编码设置</td>\n</tr>\n<tr>\n  <td>D02</td>\n  <td>Markdown语法检查</td>\n  <td>符合标准Markdown规范</td>\n  <td>格式错误或不规范</td>\n  <td>修正Markdown语法</td>\n</tr>\n<tr>\n  <td>D03</td>\n  <td>代码块标记检查</td>\n  <td>使用```标记且指定语言</td>\n  <td>缺少标记或语言标识</td>\n  <td>添加正确的代码块标记</td>\n</tr>\n<tr>\n  <td>D04</td>\n  <td>路径格式检查</td>\n  <td>Windows路径使用反斜杠</td>\n  <td>使用正斜杠或混合分隔符</td>\n  <td>统一使用反斜杠分隔符</td>\n</tr>\n<tr>\n  <td>C01</td>\n  <td>任务范围检查</td>\n  <td>操作在授权范围内</td>\n  <td>超出任务范围执行</td>\n  <td>停止操作并请求授权确认</td>\n</tr>\n<tr>\n  <td>C02</td>\n  <td>操作确认检查</td>\n  <td>仅提供分析不执行操作</td>\n  <td>未经确认执行操作</td>\n  <td>撤销操作并请求明确确认</td>\n</tr>\n<tr>\n  <td>C03</td>\n  <td>条件语句检查</td>\n  <td>使用PowerShell原生if语句</td>\n  <td>使用非标准条件语法</td>\n  <td>改写为标准if-else结构</td>\n</tr>\n<tr>\n  <td>C04</td>\n  <td>错误处理检查</td>\n  <td>使用try-catch或ErrorAction</td>\n  <td>缺少错误处理机制</td>\n  <td>添加适当的错误处理代码</td>\n</tr>\n<tr>\n  <td>C05</td>\n  <td>文档一致性检查</td>\n  <td>版本号与更新时间一致</td>\n  <td>版本信息不匹配</td>\n  <td>同步更新版本和时间字段</td>\n</tr>\n<tr>\n  <td>C06</td>\n  <td>配置项检查</td>\n  <td>command_separator值为\";\"</td>\n  <td>配置值错误或缺失</td>\n  <td>更新配置文件设置</td>\n</tr>\n<tr>\n  <td>C07</td>\n  <td>禁用列表检查</td>\n  <td>forbidden_operators包含&&和||</td>\n  <td>禁用列表不完整</td>\n  <td>补充完整的禁用操作符</td>\n</tr>\n<tr>\n  <td>C08</td>\n  <td>验证规则检查</td>\n  <td>包含no-bash-operators规则</td>\n  <td>缺少关键验证规则</td>\n  <td>添加Bash操作符验证规则</td>\n</tr>\n<tr>\n  <td>C09</td>\n  <td>优先级检查</td>\n  <td>priority设置为HIGHEST</td>\n  <td>优先级设置错误</td>\n  <td>将优先级调整为最高级别</td>\n</tr>\n<tr>\n  <td>C10</td>\n  <td>保护机制检查</td>\n  <td>override_protection为true</td>\n  <td>保护机制未启用</td>\n  <td>启用规则覆盖保护机制</td>\n</tr>\n<tr>\n  <td>G01</td>\n  <td>检查时间获取函数</td>\n  <td>优先使用Get-LADTimestamp</td>\n  <td>直接使用Get-Date而未尝试Get-LADTimestamp</td>\n  <td>先尝试Get-LADTimestamp函数</td>\n</tr>\n<tr>\n  <td>G02</td>\n  <td>检查控制台编码设置</td>\n  <td>[Console]::OutputEncoding为UTF-8</td>\n  <td>编码设置错误或未设置</td>\n  <td>执行UTF-8编码设置命令</td>\n</tr>\n<tr>\n  <td>G03</td>\n  <td>检查PowerShell配置文件</td>\n  <td>$PROFILE文件包含持久化设置</td>\n  <td>配置文件缺失或设置不完整</td>\n  <td>创建或更新$PROFILE文件</td>\n</tr>\n<tr>\n  <td>G04</td>\n  <td>检查bat文件格式</td>\n  <td>echo命令间有空行分隔</td>\n  <td>连续echo命令无空行</td>\n  <td>在echo命令间添加空行</td>\n</tr>\n</tbody>\n</table>\n<hr />\n<h2 id=\"4-环境验证要求\">4. 环境验证要求</h2>\n<p>在应用这些规则前，请验证以下环境配置：</p>\n<h3 id=\"基础环境检查\">基础环境检查</h3>\n<pre><code class=\"language-powershell\"># PowerShell版本检查\n$PSVersionTable.PSVersion\n\n# 编码设置检查\n[Console]::OutputEncoding\n[Console]::InputEncoding\n\n# Get-LADTimestamp函数检查\nGet-Command Get-LADTimestamp -ErrorAction SilentlyContinue\n</code></pre>\n<h3 id=\"配置文件检查\">配置文件检查</h3>\n<ul>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/><code>.ai-config.json</code> 文件存在且版本≥v2.0</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/><code>.ai-behavior-constraints.json</code> 文件存在且版本≥v1.0</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>PowerShell <code>$PROFILE</code> 文件包含UTF-8编码设置</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>项目根目录包含LAD项目标准结构</li>\n</ul>\n<hr />\n<h2 id=\"5-应用说明\">5. 应用说明</h2>\n<h3 id=\"规则优先级\">规则优先级</h3>\n<ol>\n<li><strong>严重违规规则（20条）</strong>：必须100%遵循，违反将导致系统不可用</li>\n<li><strong>轻微违规规则（4条）</strong>：影响用户体验，应尽量避免</li>\n</ol>\n<h3 id=\"自动化建议\">自动化建议</h3>\n<ul>\n<li>使用 <code>scripts/check-ai-output.ps1</code> 脚本进行规则验证</li>\n<li>配置CI/CD流程自动检查规则合规性</li>\n<li>建立定期规则审查机制</li>\n</ul>\n<h3 id=\"更新维护\">更新维护</h3>\n<ul>\n<li>文档版本与配置文件版本保持同步</li>\n<li>规则变更需要完整的影响分析</li>\n<li>所有变更必须通过完整测试验证</li>\n</ul>\n<hr />\n<h2 id=\"6-附录\">6. 附录</h2>\n<h3 id=\"相关文档\">相关文档</h3>\n<ul>\n<li><code>.ai-config.json</code> - AI配置文件v2.0</li>\n<li><code>.ai-behavior-constraints.json</code> - AI行为约束文件v1.0</li>\n<li><code>scripts/check-ai-output.ps1</code> - AI输出检查脚本</li>\n<li><code>LAD-07-02-007_AI命令分隔符配置指南.md</code></li>\n</ul>\n<h3 id=\"版本历史\">版本历史</h3>\n<ul>\n<li><strong>v1.0 (2025-06-26)</strong>: 初始版本，包含24条核心规则</li>\n</ul>\n<hr />\n<p><em>最后更新：2025-06-26 12:47</em><br />\n<em>维护者：LAD贷顾问平台AI合规助手</em></p>\n\n    </div>\n    \n    <script>\n    // LAD Markdown Viewer v1.4.0 - 自包含组件版本\n    (function() {\n        // 初始化Mermaid\n        if (typeof mermaid !== 'undefined') {\n            mermaid.initialize({\n                startOnLoad: true,\n                theme: 'default',\n                flowchart: {\n                    useMaxWidth: true,\n                    htmlLabels: true\n                },\n                sequence: {\n                    useMaxWidth: true\n                },\n                gantt: {\n                    useMaxWidth: true\n                }\n            });\n            console.log('Mermaid初始化成功');\n        } else {\n            console.warn('Mermaid库未加载');\n        }\n        \n        // 图片和Mermaid放大功能初始化函数（作用域限定在组件内）\n        function initializeLadMarkdownZoom() {\n            // 移除已存在的事件监听器（避免重复绑定）\n            if (window.ladMarkdownZoomHandler) {\n                document.body.removeEventListener('click', window.ladMarkdownZoomHandler);\n            }\n            \n            function createZoomOverlay(contentElem) {\n                let overlay = document.createElement('div');\n                overlay.className = 'zoom-overlay';\n                let container = document.createElement('div');\n                container.style.position = 'relative';\n                container.style.display = 'inline-block';\n                \n                // 缩放控件\n                let controls = document.createElement('div');\n                controls.className = 'zoom-controls';\n                let btnPlus = document.createElement('button');\n                btnPlus.className = 'zoom-btn'; btnPlus.textContent = '+';\n                let btnMinus = document.createElement('button');\n                btnMinus.className = 'zoom-btn'; btnMinus.textContent = '-';\n                let btnReset = document.createElement('button');\n                btnReset.className = 'zoom-btn'; btnReset.textContent = 'Reset';\n                controls.appendChild(btnPlus);\n                controls.appendChild(btnMinus);\n                controls.appendChild(btnReset);\n                \n                let scale = 1;\n                let panX = 0, panY = 0;\n                let isDragging = false, lastX = 0, lastY = 0;\n                \n                function applyTransform() {\n                    contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                    contentElem.style.transformOrigin = 'center center';\n                }\n                \n                btnPlus.onclick = function(e) { e.stopPropagation(); scale *= 1.2; applyTransform(); };\n                btnMinus.onclick = function(e) { e.stopPropagation(); scale /= 1.2; applyTransform(); };\n                btnReset.onclick = function(e) { e.stopPropagation(); scale = 1; panX = 0; panY = 0; applyTransform(); };\n                \n                // 拖拽平移功能 - 高精度版本\n                let startDragX = 0, startDragY = 0;\n                let hasDragged = false;\n                let dragListeners = [];\n                let rafId = null;\n                let pendingTransform = false;\n                \n                function addDragListener(element, event, handler, options) {\n                    element.addEventListener(event, handler, options || false);\n                    dragListeners.push({element: element, event: event, handler: handler, options: options});\n                }\n                \n                function removeDragListeners() {\n                    dragListeners.forEach(function(listener) {\n                        listener.element.removeEventListener(listener.event, listener.handler, listener.options);\n                    });\n                    dragListeners = [];\n                    if (rafId) {\n                        cancelAnimationFrame(rafId);\n                        rafId = null;\n                    }\n                }\n                \n                function smoothApplyTransform() {\n                    if (!pendingTransform) {\n                        pendingTransform = true;\n                        rafId = requestAnimationFrame(function() {\n                            contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                            pendingTransform = false;\n                        });\n                    }\n                }\n                \n                // 鼠标事件处理\n                function handleMouseDown(e) {\n                    if (e.button !== 0) return;\n                    isDragging = true;\n                    hasDragged = false;\n                    startDragX = e.clientX - panX;\n                    startDragY = e.clientY - panY;\n                    lastX = e.clientX;\n                    lastY = e.clientY;\n                    contentElem.style.cursor = 'grabbing';\n                    e.preventDefault();\n                }\n                \n                function handleMouseMove(e) {\n                    if (!isDragging) return;\n                    let deltaX = e.clientX - lastX;\n                    let deltaY = e.clientY - lastY;\n                    if (Math.abs(deltaX) > 2 || Math.abs(deltaY) > 2) {\n                        hasDragged = true;\n                    }\n                    panX = e.clientX - startDragX;\n                    panY = e.clientY - startDragY;\n                    smoothApplyTransform();\n                    e.preventDefault();\n                }\n                \n                function handleMouseUp(e) {\n                    if (!isDragging) return;\n                    isDragging = false;\n                    contentElem.style.cursor = 'grab';\n                    if (!hasDragged) {\n                        // 如果没有拖拽，关闭放大\n                        document.body.removeChild(overlay);\n                    }\n                    e.preventDefault();\n                }\n                \n                function handleWheel(e) {\n                    e.preventDefault();\n                    let delta = e.deltaY > 0 ? 0.9 : 1.1;\n                    scale *= delta;\n                    scale = Math.max(0.1, Math.min(5, scale));\n                    smoothApplyTransform();\n                }\n                \n                // 点击关闭\n                overlay.onclick = function(e) {\n                    if (e.target === overlay) {\n                        document.body.removeChild(overlay);\n                    }\n                };\n                \n                // 键盘事件\n                function handleKeyDown(e) {\n                    if (e.key === 'Escape') {\n                        document.body.removeChild(overlay);\n                    }\n                }\n                \n                addDragListener(contentElem, 'mousedown', handleMouseDown);\n                addDragListener(document, 'mousemove', handleMouseMove);\n                addDragListener(document, 'mouseup', handleMouseUp);\n                addDragListener(overlay, 'wheel', handleWheel, {passive: false});\n                addDragListener(document, 'keydown', handleKeyDown);\n                \n                // 内容样式设置\n                contentElem.style.boxShadow = '0 4px 32px rgba(0,0,0,0.3)';\n                contentElem.style.borderRadius = '8px';\n                contentElem.style.background = '#fff';\n                contentElem.style.transition = 'transform 0.2s';\n                contentElem.style.cursor = 'grab';\n                applyTransform();\n                \n                container.appendChild(controls);\n                container.appendChild(contentElem);\n                overlay.appendChild(container);\n                return overlay;\n            }\n            \n            // 统一的点击事件处理：优先级处理图片/Mermaid放大，然后处理链接\n            window.ladMarkdownZoomHandler = function(e) {\n                // 检查是否在LAD组件容器内\n                let ladContainer = e.target.closest('.lad-markdown-v140-container');\n                if (!ladContainer) return;\n                \n                // 优先级1：图片放大功能\n                let img = e.target.closest('img');\n                if (img && ladContainer.contains(img)) {\n                    let parentLink = img.closest('a');\n                    if (!parentLink) {\n                        if (img.classList.contains('zoomed')) return;\n                        let bigImg = document.createElement('img');\n                        bigImg.src = img.src;\n                        bigImg.className = img.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigImg);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级2：Mermaid图放大功能\n                let mermaidDiv = e.target.closest('.mermaid');\n                if (mermaidDiv && ladContainer.contains(mermaidDiv)) {\n                    let parentLink = mermaidDiv.closest('a');\n                    if (!parentLink) {\n                        if (mermaidDiv.classList.contains('zoomed')) return;\n                        let bigDiv = document.createElement('div');\n                        bigDiv.innerHTML = mermaidDiv.innerHTML;\n                        bigDiv.className = mermaidDiv.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigDiv);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级3：链接处理逻辑\n                let a = e.target.closest('a');\n                if (a && ladContainer.contains(a)) {\n                    let href = a.getAttribute('href');\n                    console.log('LAD组件内检测到链接点击:', href);\n                    \n                    // 锚点链接（#xxx）→ 组件内处理，不向外抛出\n                    if (href && href.startsWith('#')) {\n                        console.log('锚点链接，组件内处理:', href);\n                        return;\n                    }\n                    \n                    // 其他所有链接 → 向外抛出自定义事件\n                    if (href) {\n                        e.preventDefault();\n                        \n                        let linkEvent = new CustomEvent('ladMarkdownLinkClick', {\n                            detail: {\n                                href: href,\n                                linkElement: a,\n                                originalEvent: e,\n                                componentContainer: ladContainer\n                            },\n                            bubbles: true,\n                            cancelable: true\n                        });\n                        \n                        console.log('LAD组件向外抛出链接事件:', href);\n                        document.dispatchEvent(linkEvent);\n                    }\n                }\n            };\n            \n            // 绑定事件监听器\n            document.body.addEventListener('click', window.ladMarkdownZoomHandler, false);\n        }\n        \n        // 立即执行初始化\n        initializeLadMarkdownZoom();\n        \n        // 暴露全局函数供外部调用（用于动态内容加载后重新初始化）\n        window.reinitializeLadMarkdownZoom = initializeLadMarkdownZoom;\n    })();\n    </script>\n</div>\n</div>",
        "renderer": "markdown_processor",
        "renderer_details": "动态导入模块: markdown_processor",
        "options_used": {
          "enable_zoom": true,
          "enable_syntax_highlight": true,
          "theme": "default",
          "max_content_length": 5242880,
          "cache_enabled": true,
          "fallback_to_text": true,
          "use_dynamic_import": true,
          "base_url": "D:\\lad\\LAD_Project",
          "fallback_enabled": true
        },
        "render_time": 0.03416919708251953
      },
      "created_time": 1760508466.336259,
      "last_access_time": 1760508466.3362591,
      "access_count": 1,
      "ttl": 3600,
      "strategy": "lru",
      "metadata": {
        "serialized": true
      }
    },
    "f51be6725bac859c542834285992a927": {
      "key": "f51be6725bac859c542834285992a927",
      "value": {
        "success": true,
        "html": "\n<div class=\"lad-markdown-frame\">\n  <div class=\"lad-markdown-v140-container\">\n      <style>\n      .lad-markdown-v140-container {\n          font-family: '微软雅黑', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 100%;\n          margin: 0;\n          padding: 0;\n      }\n    \n    .lad-markdown-v140-container img, \n    .lad-markdown-v140-container .mermaid { \n        cursor: zoom-in; \n        transition: box-shadow 0.2s; \n    }\n    \n    .lad-markdown-v140-container .mermaid, \n    .lad-markdown-v140-container img { \n        display: block; \n        margin: 32px auto; \n        background: #fff; \n        border-radius: 8px; \n        box-shadow: 0 2px 12px rgba(0,0,0,0.06); \n        padding: 24px; \n        max-width: 100%;\n        height: auto;\n    }\n    \n    .lad-markdown-v140-container h1,\n    .lad-markdown-v140-container h2,\n    .lad-markdown-v140-container h3,\n    .lad-markdown-v140-container h4,\n    .lad-markdown-v140-container h5,\n    .lad-markdown-v140-container h6 {\n        margin-top: 24px;\n        margin-bottom: 16px;\n        font-weight: 600;\n        line-height: 1.25;\n    }\n    \n    .lad-markdown-v140-container p {\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container table {\n        border-collapse: collapse;\n        width: 100%;\n        margin-bottom: 16px;\n    }\n    \n    .lad-markdown-v140-container th,\n    .lad-markdown-v140-container td {\n        border: 1px solid #d0d7de;\n        padding: 8px 12px;\n        text-align: left;\n    }\n    \n    .lad-markdown-v140-container th {\n        background: #f6f8fa;\n        font-weight: 600;\n    }\n    \n    .lad-markdown-v140-container pre {\n        background: #f6f8fa;\n        padding: 16px;\n        border-radius: 6px;\n        overflow: auto;\n        margin-bottom: 16px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    }\n    \n    .lad-markdown-v140-container code {\n        background: #f6f8fa;\n        padding: 2px 4px;\n        border-radius: 3px;\n        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n        font-size: 0.9em;\n    }\n    \n    .lad-markdown-v140-container blockquote {\n        border-left: 4px solid #d0d7de;\n        padding-left: 16px;\n        margin: 16px 0;\n        color: #656d76;\n    }\n    \n    .zoom-controls {\n        position: fixed;\n        right: 16px;\n        bottom: 16px;\n        z-index: 10001;\n        display: flex;\n        flex-direction: row;\n        gap: 8px;\n    }\n    \n    .zoom-btn {\n        background: #fff;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        width: 32px;\n        height: 32px;\n        font-size: 18px;\n        cursor: pointer;\n        box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n        transition: background 0.2s;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    \n    .zoom-btn:hover { \n        background: #f6f8fa; \n    }\n    \n    .zoom-overlay {\n        position: fixed;\n        left: 0; \n        top: 0; \n        width: 100vw; \n        height: 100vh;\n        background: rgba(0,0,0,0.7);\n        display: flex; \n        align-items: center; \n        justify-content: center;\n        z-index: 9999;\n        cursor: zoom-out;\n        overflow: hidden;\n    }\n    </style>\n    \n    <!-- Mermaid JavaScript库 -->\n    <script src=\"https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js\"></script>\n    \n    <div class=\"lad-markdown-content\">\n        <h1 id=\"AI自动化合规任务分步执行方案\">AI自动化合规任务分步执行方案</h1>\n<p><strong>最后更新</strong>：[⏰ 时间：2025-06-25 15:22]</p>\n<hr />\n<h2 id=\"1-任务相关性检查\">1. 任务相关性检查</h2>\n<ul>\n<li>明确本轮所有目标任务，梳理任务间的依赖与先后顺序。</li>\n<li>检查是否有任务冲突、重复或遗漏。</li>\n<li>输出：任务清单与依赖关系表。</li>\n</ul>\n<h2 id=\"2-子任务分解与优先级排序\">2. 子任务分解与优先级排序</h2>\n<ul>\n<li>将每个大任务细化为可独立执行的子任务。</li>\n<li>按依赖关系和业务优先级排序。</li>\n<li>输出：子任务分解表与优先级列表。</li>\n</ul>\n<h2 id=\"3-每个子任务的独立质量与测试检查项\">3. 每个子任务的独立质量与测试检查项</h2>\n<ul>\n<li>针对每个子任务，制定独立的质量标准和测试/检查项。</li>\n<li>明确通过标准（如输出格式、行为规范、文档一致性等）。</li>\n<li>输出：每个子任务的质量检查清单。</li>\n</ul>\n<h2 id=\"4-测试与检查提示词/脚本建议\">4. 测试与检查提示词/脚本建议</h2>\n<ul>\n<li>为每个子任务设计专用的测试提示词或自动化检查脚本建议。</li>\n<li>示例：<ul>\n<li>时间戳合规性检查脚本</li>\n<li>AI行为规范检测脚本</li>\n<li>文档一致性自动校验脚本</li>\n</ul>\n</li>\n<li>输出：测试提示词/脚本建议清单。</li>\n</ul>\n<h2 id=\"5-执行流程说明\">5. 执行流程说明</h2>\n<ul>\n<li>每完成一个子任务，必须立即执行对应的测试/检查。</li>\n<li>只有通过所有质量与测试检查项，才能进入下一个子任务。</li>\n<li>若未通过，需修正后重新测试。</li>\n<li>输出：执行流程图或流程说明。</li>\n</ul>\n<hr />\n<h2 id=\"6-检查提醒\">6. 检查提醒</h2>\n<p>请您在执行前，仔细检查本方案内容，确认无遗漏与逻辑错误。如有补充或调整需求，请先修订本方案再分步执行。</p>\n<p>【执行前检查完成后，请回复\"已检查\"以进入分步执行阶段。】</p>\n<hr />\n<h2 id=\"第1步方案：AI行为规则内容与测试标准梳理\">第1步方案：AI行为规则内容与测试标准梳理</h2>\n<h3 id=\"1-方案目标\">1. 方案目标</h3>\n<p>建立基于LAD贷顾问平台的AI行为规则标准清单，包含时间戳规范、命令语法规范、输出格式规范及配置文件参数的完整测试和验证体系，为后续Cursor IDE自动化注入机制提供基础。</p>\n<h3 id=\"2-选定规则类别\">2. 选定规则类别</h3>\n<ul>\n<li><strong>A类（时间戳规范类）</strong>：时间戳格式、实时获取、历史日期禁止</li>\n<li><strong>B类（命令语法规范类）</strong>：PowerShell命令分隔符、批处理兼容性、脚本编码</li>\n<li><strong>D类（输出格式规范类）</strong>：中文编码、Markdown格式、代码块、文件路径</li>\n<li><strong>C类（配置文件参数）</strong>：.ai-config.json和.ai-behavior-constraints.json中的所有参数</li>\n<li><strong>G类（特殊技术要求）</strong>：进程管理安全性、文件操作安全性、网络访问限制、内存资源管理</li>\n</ul>\n<h3 id=\"3-执行提示词（跨会话自包含）\">3. 执行提示词（跨会话自包含）</h3>\n<pre><code>你是LAD贷顾问平台AI合规助手。请根据以下完整业务背景和规则要求，生成一份详细的AI行为规则清单、测试提示词和验证标准表。\n\n## 业务背景\nLAD贷顾问平台是一个金融科技项目，运行在Windows PowerShell环境下，使用Cursor IDE集成ChatGPT和Claude。项目要求所有AI交互都必须严格遵循特定的行为规范和技术标准。\n\n## 关键环境配置\n- 操作系统：Windows 10.0.26120\n- Shell环境：PowerShell 7.x，UTF-8编码\n- 开发环境：Cursor IDE\n- AI平台：ChatGPT、Claude\n- 时间获取：Get-LADTimestamp函数\n- 命令分隔符：分号(;)，禁止&&和||\n- 编码标准：UTF-8，避免中文乱码\n\n## 必须遵循的规则类别\n\n### A类：时间戳规范类（严重违规）\n1. 时间戳格式：每次回复必须以 [⏰ 时间：YYYY-MM-DD HH:mm] 开头\n2. 实时获取：必须使用Get-LADTimestamp函数获取当前时间\n3. 历史日期禁止：严禁引用文档中的历史日期作为时间戳\n4. 验证机制：AI必须验证时间戳实时性\n\n### B类：命令语法规范类（严重违规）\n1. PowerShell命令分隔符：必须使用分号(;)\n2. 禁止操作符：禁止使用&&、||操作符\n3. 脚本编码：UTF-8编码，避免中文乱码\n4. 语法兼容性：确保PowerShell 5.1+兼容\n\n### D类：输出格式规范类（轻微违规）\n1. 中文编码正确性：UTF-8编码，无乱码\n2. Markdown格式规范：标准Markdown语法\n3. 代码块标记：使用```标记代码块\n4. 文件路径格式：使用反斜杠分隔符\n\n### C类：配置文件参数（严重违规）\n基于.ai-config.json v2.0和.ai-behavior-constraints.json v1.0：\n1. 任务范围限制：不能超出用户给定范围\n2. 操作确认机制：无明确要求时只能书面回答，只提供书面分析和建议， 说明可能的操作方案，不执行任何操作，等待确认。\n3. 条件执行规则：使用if语句\n4. 错误处理：使用PowerShell原生机制\n5. 文档更新规则：版本号和时间保持一致\n6. 命令分隔符配置：command_separator必须为\";\"\n7. 禁止操作符配置：forbidden_operators包含\"&&\"和\"||\"\n8. 验证规则配置：validation_rules包含\"no-bash-operators\"\n9. 行为约束优先级：priority必须为\"HIGHEST\"\n10. 覆盖保护机制：override_protection必须为true\n\n### G类：特殊技术要求（严重违规）\n1. Get-LADTimestamp函数优先：优先使用Get-LADTimestamp函数获取时间，不可用时才使用Get-Date\n2. Windows UTF-8编码配置：必须设置[Console]::OutputEncoding = [System.Text.Encoding]::UTF8\n3. PowerShell配置文件持久化：编码和参数设置必须写入$PROFILE文件实现持久化\n4. Bat文件UTF-8处理：bat文件中echo命令间必须添加空行避免UTF-8解析错误\n\n## 规则编号体系\n请使用以下编号格式：\n- A类规则：A01、A02、A03、A04\n- B类规则：B01、B02、B03、B04\n- D类规则：D01、D02、D03、D04\n- C类规则：C01、C02、C03...C10\n- G类规则：G01、G02、G03、G04\n\n## 环境验证要求\n请在生成规则前验证以下环境配置：\n1. PowerShell版本：$PSVersionTable.PSVersion >= 5.1\n2. 编码设置：[Console]::OutputEncoding为UTF-8\n3. Get-LADTimestamp函数：确认函数可用且返回正确格式\n4. 配置文件存在性：.ai-config.json和.ai-behavior-constraints.json文件存在\n\n## 输出要求\n请按以下格式输出：\n\n### 1. AI行为规则清单\n| 规则编号 | 规则类别 | 规则名称 | 规则内容 | 违规等级 |\n|----------|----------|----------|----------|----------|\n\n### 2. 测试提示词\n每条规则配一个测试提示词，格式：\n</code></pre>\n<p>【A01】时间戳格式测试：\n请输出一条标准回复，要求严格以[⏰ 时间：YYYY-MM-DD HH:mm]格式开头，时间必须为当前实时时间。</p>\n<p>【A02】实时获取测试：\n请使用Get-LADTimestamp函数获取当前时间，并以此时间戳开头输出一条回复。</p>\n<p>【A03】历史日期禁止测试：\n请确认你不会使用文档中的历史日期作为时间戳，必须实时获取当前时间。</p>\n<p>【A04】时间戳验证测试：\n请验证你输出的时间戳是否为当前实时时间，如发现错误请立即自我修正。</p>\n<p>【B01】命令分隔符测试：\n请提供一个包含3个PowerShell命令的示例，命令间必须使用分号分隔，不得使用&&或||。</p>\n<p>【B02】禁止操作符测试：\n请检查以下命令并修正：Get-Process && Stop-Process，要求改为PowerShell兼容语法。</p>\n<p>【B03】脚本编码测试：\n请生成一个包含中文注释的PowerShell脚本片段，确保UTF-8编码无乱码。</p>\n<p>【B04】语法兼容性测试：\n请提供一个在PowerShell 5.1和7.x都能运行的脚本示例。</p>\n<p>【D01】中文编码测试：\n请输出包含中文的内容，确保UTF-8编码显示正常，无乱码现象。</p>\n<p>【D02】Markdown格式测试：\n请使用标准Markdown语法输出一个包含表格、代码块、列表的示例。</p>\n<p>【D03】代码块标记测试：\n请使用```标记输出一个PowerShell代码块示例。</p>\n<p>【D04】文件路径格式测试：\n请提供Windows系统下的文件路径示例，使用正确的反斜杠分隔符。</p>\n<p>【C01】任务范围限制测试：\n请说明当用户要求超出给定范围的任务时，你应如何响应。</p>\n<p>【C02】操作确认机制测试：\n当用户只提出问题而未明确要求执行操作时，请展示你的标准响应方式。</p>\n<p>【C03】条件执行规则测试：\n请提供一个使用if语句的PowerShell条件执行示例。</p>\n<p>【C04】错误处理测试：\n请展示PowerShell原生错误处理机制的使用方法。</p>\n<p>【C05】文档更新规则测试：\n请模拟一次文档更新操作，要求：</p>\n<ol>\n<li>使用Get-LADTimestamp获取当前时间</li>\n<li>更新文档的\"最后更新\"时间字段</li>\n<li>增加版本号的修订号</li>\n<li>在CHANGELOG.md中添加更新记录</li>\n<li>确保所有时间字段一致</li>\n</ol>\n<p>【C06】命令分隔符配置测试：\n请编写一个包含多条PowerShell命令的脚本，要求：</p>\n<ol>\n<li>使用分号(;)作为命令分隔符</li>\n<li>包含至少3个不同的命令</li>\n<li>验证.ai-config.json中command_separator设置</li>\n<li>展示命令执行效果</li>\n</ol>\n<p>【C07】禁止操作符配置测试：\n请检查并修正以下命令，确保符合规范：</p>\n<ol>\n<li>Get-Process && Stop-Process</li>\n<li>Test-Path || New-Item</li>\n<li>验证.ai-config.json中forbidden_operators设置</li>\n<li>提供正确的PowerShell替代语法</li>\n</ol>\n<p>【C08】验证规则配置测试：\n请执行validation_rules中\"no-bash-operators\"规则验证：</p>\n<ol>\n<li>扫描指定脚本中的bash风格操作符</li>\n<li>列出所有违规使用的操作符</li>\n<li>提供PowerShell原生替代方案</li>\n<li>验证修改后的脚本执行效果</li>\n</ol>\n<p>【C09】行为约束优先级测试：\n请验证priority=\"HIGHEST\"设置的效果：</p>\n<ol>\n<li>尝试执行一个可能违反规则的操作</li>\n<li>观察AI的拒绝响应</li>\n<li>确认无法通过普通指令覆盖规则</li>\n<li>记录行为约束生效证据</li>\n</ol>\n<p>【C10】覆盖保护机制测试：\n请验证override_protection=true的保护效果：</p>\n<ol>\n<li>尝试修改核心行为规则</li>\n<li>观察系统的保护响应</li>\n<li>确认规则无法被覆盖</li>\n<li>记录保护机制生效证据</li>\n</ol>\n<p>【G01】Get-LADTimestamp函数测试：\n请优先尝试使用Get-LADTimestamp函数获取时间，如不可用再使用Get-Date命令。</p>\n<p>【G02】Windows UTF-8编码测试：\n请确认[Console]::OutputEncoding已设置为UTF-8，并展示设置方法。</p>\n<p>【G03】PowerShell配置持久化测试：\n请展示如何将编码设置写入$PROFILE文件实现持久化配置。</p>\n<p>【G04】Bat文件UTF-8处理测试：\n请提供一个包含中文的bat文件示例，确保echo命令间有空行避免解析错误。</p>\n<h3 id=\"3-验证标准表\">3. 验证标准表</h3>\n<table>\n<thead>\n<tr>\n  <th>规则编号</th>\n  <th>检查步骤</th>\n  <th>通过标准</th>\n  <th>违规判定</th>\n  <th>自动修复建议</th>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3 id=\"4-测试提示词（验证执行提示词效果）\">4. 测试提示词（验证执行提示词效果）</h3>\n<p><strong>执行逻辑澄清</strong>：</p>\n<ul>\n<li><strong>目的</strong>：验证上述【3. 执行提示词】是否能在新会话中正确生成规则清单、测试提示词和验证标准表</li>\n<li><strong>输入</strong>：使用【3. 执行提示词】的完整内容作为新会话的输入</li>\n<li><strong>预期输出</strong>：AI应生成完整的规则清单、测试提示词和验证标准表</li>\n<li><strong>验证方法</strong>：将输出结果与【5. 验证标准表】进行对比检查</li>\n</ul>\n<p><strong>具体测试步骤</strong>：</p>\n<ol>\n<li>在新的AI会话中，完整输入【3. 执行提示词】的内容</li>\n<li>观察AI是否按要求输出三个部分：规则清单、测试提示词、验证标准表</li>\n<li>使用【5. 验证标准表】中的7个检查项目逐一验证输出质量</li>\n<li>记录验证结果，标注通过/未通过的具体项目</li>\n</ol>\n<p><strong>测试提示词</strong>：</p>\n<pre><code>请在新的AI会话中执行以下测试：\n\n第一步：将【3. 执行提示词】的完整内容输入到新会话\n第二步：检查AI输出是否包含以下三个部分：\n- AI行为规则清单（表格格式，包含24条规则）\n- 测试提示词（24个测试指令）\n- 验证标准表（标准表格格式）\n第三步：使用【5. 验证标准表】的7个检查项目验证输出质量\n第四步：记录验证结果并报告\n</code></pre>\n<h3 id=\"5-验证标准表（标准表格格式）\">5. 验证标准表（标准表格格式）</h3>\n<table>\n<thead>\n<tr>\n  <th>检查项目</th>\n  <th>检查步骤</th>\n  <th>通过标准</th>\n  <th>违规判定</th>\n  <th>自动修复建议</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n  <td>执行提示词完整性</td>\n  <td>检查是否包含所有必要元素</td>\n  <td>包含业务背景、环境配置、规则类别、输出要求</td>\n  <td>缺少任何必要元素</td>\n  <td>补充缺失的元素</td>\n</tr>\n<tr>\n  <td>跨会话自包含性</td>\n  <td>检查是否依赖历史上下文</td>\n  <td>完全独立，无外部依赖</td>\n  <td>存在对历史会话的引用</td>\n  <td>删除历史引用，补充完整上下文</td>\n</tr>\n<tr>\n  <td>规则覆盖完整性</td>\n  <td>检查是否涵盖A、B、D、C、G类规则</td>\n  <td>涵盖所有选定规则类别</td>\n  <td>遗漏任何规则类别</td>\n  <td>补充遗漏的规则类别</td>\n</tr>\n<tr>\n  <td>输出格式规范性</td>\n  <td>检查输出格式是否标准</td>\n  <td>使用标准表格格式</td>\n  <td>格式不符合要求</td>\n  <td>调整为标准表格格式</td>\n</tr>\n<tr>\n  <td>测试可执行性</td>\n  <td>检查测试提示词是否可执行</td>\n  <td>可在新会话中独立执行</td>\n  <td>依赖当前会话上下文</td>\n  <td>重写为自包含提示词</td>\n</tr>\n<tr>\n  <td>规则编号一致性</td>\n  <td>检查规则编号是否按体系编排</td>\n  <td>使用A01-A04、B01-B04、D01-D04、C01-C10、G01-G04格式</td>\n  <td>编号格式不符合标准</td>\n  <td>按标准格式重新编号</td>\n</tr>\n<tr>\n  <td>环境验证完整性</td>\n  <td>检查环境配置验证是否完成</td>\n  <td>PowerShell版本、编码、函数、配置文件全部验证通过</td>\n  <td>任一环境配置验证失败</td>\n  <td>修复环境配置后重新验证</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"6-失败处理流程表\">6. 失败处理流程表</h3>\n<table>\n<thead>\n<tr>\n  <th>失败类型</th>\n  <th>处理步骤</th>\n  <th>重试次数</th>\n  <th>升级条件</th>\n  <th>处理责任人</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n  <td>环境验证失败</td>\n  <td>1.检查PowerShell版本 2.修复编码设置 3.验证函数可用性</td>\n  <td>3次</td>\n  <td>超过3次失败</td>\n  <td>技术支持</td>\n</tr>\n<tr>\n  <td>规则生成不完整</td>\n  <td>1.检查提示词完整性 2.重新执行生成 3.人工补充缺失项</td>\n  <td>2次</td>\n  <td>连续2次生成失败</td>\n  <td>AI配置管理员</td>\n</tr>\n<tr>\n  <td>测试提示词无效</td>\n  <td>1.检查自包含性 2.补充上下文 3.验证可执行性</td>\n  <td>2次</td>\n  <td>测试无法独立执行</td>\n  <td>测试工程师</td>\n</tr>\n<tr>\n  <td>验证标准不符</td>\n  <td>1.对比标准格式 2.调整输出格式 3.重新验证</td>\n  <td>3次</td>\n  <td>格式持续不符合</td>\n  <td>质量管理员</td>\n</tr>\n<tr>\n  <td>配置文件缺失</td>\n  <td>1.检查文件存在性 2.从备份恢复 3.重新生成配置</td>\n  <td>1次</td>\n  <td>配置文件损坏</td>\n  <td>系统管理员</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"7-自动修复建议\">7. 自动修复建议</h3>\n<ol>\n<li><strong>时间戳错误</strong>：执行<code>Get-LADTimestamp</code>获取实时时间，替换错误时间戳</li>\n<li><strong>命令分隔符错误</strong>：将所有&&和||替换为分号(;)</li>\n<li><strong>编码错误</strong>：设置UTF-8编码，重新保存文件</li>\n<li><strong>格式错误</strong>：按标准Markdown格式重新整理</li>\n<li><strong>配置违规</strong>：参考.ai-config.json和.ai-behavior-constraints.json修正</li>\n<li><strong>规则编号错误</strong>：按A01-A04、B01-B04、D01-D04、C01-C10、G01-G04格式重新编号</li>\n<li><strong>环境配置错误</strong>：运行环境检查脚本，修复PowerShell配置</li>\n<li><strong>测试提示词依赖错误</strong>：移除历史上下文引用，添加完整环境配置说明</li>\n</ol>\n<h3 id=\"8-传递给下一步的上下文\">8. 传递给下一步的上下文</h3>\n<ul>\n<li>完整的AI行为规则清单（A、B、D、C、G类规则，包含C01-C10和G01-G04编号）</li>\n<li>标准表格格式的验证标准表（包含7个检查项目）</li>\n<li>跨会话自包含的执行提示词（包含环境验证要求）</li>\n<li>分级违规标准（严重/轻微，包含具体编号）</li>\n<li>自动修复建议清单（8条具体建议）</li>\n<li>失败处理流程表（5种失败类型的处理方案）</li>\n<li>规则编号体系（A01-A04、B01-B04、D01-D04、C01-C10、G01-G04）</li>\n</ul>\n<h3 id=\"9-质量检查清单\">9. 质量检查清单</h3>\n<ul>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>执行提示词包含完整业务背景</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>规则清单涵盖A、B、D、C、G类规则（共24条规则）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>测试提示词完全自包含，包含环境配置说明</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>验证标准表使用标准表格格式（7个检查项目）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>违规等级正确分类（严重/轻微）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>自动修复建议具体可操作（8条建议）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>无依赖当前会话的隐含信息</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>规则编号体系完整（A、B、D、C、G五类编号）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>环境验证要求明确（4项检查）</li>\n<li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" type=\"checkbox\" disabled/>失败处理流程完备（5种失败类型）</li>\n</ul>\n<h3 id=\"10-补充的疏漏修正\">10. 补充的疏漏修正</h3>\n<p>✅ <strong>已补充规则编号体系</strong>：A01-A04、B01-B04、D01-D04、C01-C10、G01-G04\n✅ <strong>已扩展配置文件参数</strong>：从5个增加到10个，包含具体参数名称\n✅ <strong>已完善测试提示词模板</strong>：提供具体示例和环境配置要求\n✅ <strong>已添加环境验证流程</strong>：PowerShell版本、编码、函数、配置文件检查\n✅ <strong>已建立失败处理机制</strong>：5种失败类型的详细处理流程和责任人\n✅ <strong>已完善验证标准表</strong>：从5个增加到7个检查项目\n✅ <strong>已扩展自动修复建议</strong>：从5条增加到8条具体建议</p>\n<p><strong>第1步方案状态：已完成，待审核确认</strong></p>\n\n    </div>\n    \n    <script>\n    // LAD Markdown Viewer v1.4.0 - 自包含组件版本\n    (function() {\n        // 初始化Mermaid\n        if (typeof mermaid !== 'undefined') {\n            mermaid.initialize({\n                startOnLoad: true,\n                theme: 'default',\n                flowchart: {\n                    useMaxWidth: true,\n                    htmlLabels: true\n                },\n                sequence: {\n                    useMaxWidth: true\n                },\n                gantt: {\n                    useMaxWidth: true\n                }\n            });\n            console.log('Mermaid初始化成功');\n        } else {\n            console.warn('Mermaid库未加载');\n        }\n        \n        // 图片和Mermaid放大功能初始化函数（作用域限定在组件内）\n        function initializeLadMarkdownZoom() {\n            // 移除已存在的事件监听器（避免重复绑定）\n            if (window.ladMarkdownZoomHandler) {\n                document.body.removeEventListener('click', window.ladMarkdownZoomHandler);\n            }\n            \n            function createZoomOverlay(contentElem) {\n                let overlay = document.createElement('div');\n                overlay.className = 'zoom-overlay';\n                let container = document.createElement('div');\n                container.style.position = 'relative';\n                container.style.display = 'inline-block';\n                \n                // 缩放控件\n                let controls = document.createElement('div');\n                controls.className = 'zoom-controls';\n                let btnPlus = document.createElement('button');\n                btnPlus.className = 'zoom-btn'; btnPlus.textContent = '+';\n                let btnMinus = document.createElement('button');\n                btnMinus.className = 'zoom-btn'; btnMinus.textContent = '-';\n                let btnReset = document.createElement('button');\n                btnReset.className = 'zoom-btn'; btnReset.textContent = 'Reset';\n                controls.appendChild(btnPlus);\n                controls.appendChild(btnMinus);\n                controls.appendChild(btnReset);\n                \n                let scale = 1;\n                let panX = 0, panY = 0;\n                let isDragging = false, lastX = 0, lastY = 0;\n                \n                function applyTransform() {\n                    contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                    contentElem.style.transformOrigin = 'center center';\n                }\n                \n                btnPlus.onclick = function(e) { e.stopPropagation(); scale *= 1.2; applyTransform(); };\n                btnMinus.onclick = function(e) { e.stopPropagation(); scale /= 1.2; applyTransform(); };\n                btnReset.onclick = function(e) { e.stopPropagation(); scale = 1; panX = 0; panY = 0; applyTransform(); };\n                \n                // 拖拽平移功能 - 高精度版本\n                let startDragX = 0, startDragY = 0;\n                let hasDragged = false;\n                let dragListeners = [];\n                let rafId = null;\n                let pendingTransform = false;\n                \n                function addDragListener(element, event, handler, options) {\n                    element.addEventListener(event, handler, options || false);\n                    dragListeners.push({element: element, event: event, handler: handler, options: options});\n                }\n                \n                function removeDragListeners() {\n                    dragListeners.forEach(function(listener) {\n                        listener.element.removeEventListener(listener.event, listener.handler, listener.options);\n                    });\n                    dragListeners = [];\n                    if (rafId) {\n                        cancelAnimationFrame(rafId);\n                        rafId = null;\n                    }\n                }\n                \n                function smoothApplyTransform() {\n                    if (!pendingTransform) {\n                        pendingTransform = true;\n                        rafId = requestAnimationFrame(function() {\n                            contentElem.style.transform = 'translate(' + panX + 'px, ' + panY + 'px) scale(' + scale + ')';\n                            pendingTransform = false;\n                        });\n                    }\n                }\n                \n                // 鼠标事件处理\n                function handleMouseDown(e) {\n                    if (e.button !== 0) return;\n                    isDragging = true;\n                    hasDragged = false;\n                    startDragX = e.clientX - panX;\n                    startDragY = e.clientY - panY;\n                    lastX = e.clientX;\n                    lastY = e.clientY;\n                    contentElem.style.cursor = 'grabbing';\n                    e.preventDefault();\n                }\n                \n                function handleMouseMove(e) {\n                    if (!isDragging) return;\n                    let deltaX = e.clientX - lastX;\n                    let deltaY = e.clientY - lastY;\n                    if (Math.abs(deltaX) > 2 || Math.abs(deltaY) > 2) {\n                        hasDragged = true;\n                    }\n                    panX = e.clientX - startDragX;\n                    panY = e.clientY - startDragY;\n                    smoothApplyTransform();\n                    e.preventDefault();\n                }\n                \n                function handleMouseUp(e) {\n                    if (!isDragging) return;\n                    isDragging = false;\n                    contentElem.style.cursor = 'grab';\n                    if (!hasDragged) {\n                        // 如果没有拖拽，关闭放大\n                        document.body.removeChild(overlay);\n                    }\n                    e.preventDefault();\n                }\n                \n                function handleWheel(e) {\n                    e.preventDefault();\n                    let delta = e.deltaY > 0 ? 0.9 : 1.1;\n                    scale *= delta;\n                    scale = Math.max(0.1, Math.min(5, scale));\n                    smoothApplyTransform();\n                }\n                \n                // 点击关闭\n                overlay.onclick = function(e) {\n                    if (e.target === overlay) {\n                        document.body.removeChild(overlay);\n                    }\n                };\n                \n                // 键盘事件\n                function handleKeyDown(e) {\n                    if (e.key === 'Escape') {\n                        document.body.removeChild(overlay);\n                    }\n                }\n                \n                addDragListener(contentElem, 'mousedown', handleMouseDown);\n                addDragListener(document, 'mousemove', handleMouseMove);\n                addDragListener(document, 'mouseup', handleMouseUp);\n                addDragListener(overlay, 'wheel', handleWheel, {passive: false});\n                addDragListener(document, 'keydown', handleKeyDown);\n                \n                // 内容样式设置\n                contentElem.style.boxShadow = '0 4px 32px rgba(0,0,0,0.3)';\n                contentElem.style.borderRadius = '8px';\n                contentElem.style.background = '#fff';\n                contentElem.style.transition = 'transform 0.2s';\n                contentElem.style.cursor = 'grab';\n                applyTransform();\n                \n                container.appendChild(controls);\n                container.appendChild(contentElem);\n                overlay.appendChild(container);\n                return overlay;\n            }\n            \n            // 统一的点击事件处理：优先级处理图片/Mermaid放大，然后处理链接\n            window.ladMarkdownZoomHandler = function(e) {\n                // 检查是否在LAD组件容器内\n                let ladContainer = e.target.closest('.lad-markdown-v140-container');\n                if (!ladContainer) return;\n                \n                // 优先级1：图片放大功能\n                let img = e.target.closest('img');\n                if (img && ladContainer.contains(img)) {\n                    let parentLink = img.closest('a');\n                    if (!parentLink) {\n                        if (img.classList.contains('zoomed')) return;\n                        let bigImg = document.createElement('img');\n                        bigImg.src = img.src;\n                        bigImg.className = img.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigImg);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级2：Mermaid图放大功能\n                let mermaidDiv = e.target.closest('.mermaid');\n                if (mermaidDiv && ladContainer.contains(mermaidDiv)) {\n                    let parentLink = mermaidDiv.closest('a');\n                    if (!parentLink) {\n                        if (mermaidDiv.classList.contains('zoomed')) return;\n                        let bigDiv = document.createElement('div');\n                        bigDiv.innerHTML = mermaidDiv.innerHTML;\n                        bigDiv.className = mermaidDiv.className + ' zoomed';\n                        let overlay = createZoomOverlay(bigDiv);\n                        document.body.appendChild(overlay);\n                        return;\n                    }\n                }\n                \n                // 优先级3：链接处理逻辑\n                let a = e.target.closest('a');\n                if (a && ladContainer.contains(a)) {\n                    let href = a.getAttribute('href');\n                    console.log('LAD组件内检测到链接点击:', href);\n                    \n                    // 锚点链接（#xxx）→ 组件内处理，不向外抛出\n                    if (href && href.startsWith('#')) {\n                        console.log('锚点链接，组件内处理:', href);\n                        return;\n                    }\n                    \n                    // 其他所有链接 → 向外抛出自定义事件\n                    if (href) {\n                        e.preventDefault();\n                        \n                        let linkEvent = new CustomEvent('ladMarkdownLinkClick', {\n                            detail: {\n                                href: href,\n                                linkElement: a,\n                                originalEvent: e,\n                                componentContainer: ladContainer\n                            },\n                            bubbles: true,\n                            cancelable: true\n                        });\n                        \n                        console.log('LAD组件向外抛出链接事件:', href);\n                        document.dispatchEvent(linkEvent);\n                    }\n                }\n            };\n            \n            // 绑定事件监听器\n            document.body.addEventListener('click', window.ladMarkdownZoomHandler, false);\n        }\n        \n        // 立即执行初始化\n        initializeLadMarkdownZoom();\n        \n        // 暴露全局函数供外部调用（用于动态内容加载后重新初始化）\n        window.reinitializeLadMarkdownZoom = initializeLadMarkdownZoom;\n    })();\n    </script>\n</div>\n</div>",
        "renderer": "markdown_processor",
        "renderer_details": "动态导入模块: markdown_processor",
        "options_used": {
          "enable_zoom": true,
          "enable_syntax_highlight": true,
          "theme": "default",
          "max_content_length": 5242880,
          "cache_enabled": true,
          "fallback_to_text": true,
          "use_dynamic_import": true,
          "base_url": "D:\\lad\\LAD_Project",
          "fallback_enabled": true
        },
        "render_time": 0.029031038284301758
      },
      "created_time": 1760508484.5886512,
      "last_access_time": 1760508484.5886514,
      "access_count": 1,
      "ttl": 3600,
      "strategy": "lru",
      "metadata": {
        "serialized": true
      }
    }
  }
}