# 第二阶段核心功能实现 - 提示词1：文件解析器实现

[⏰ 时区时间：YYYY-MM-DD HH:mm]

## 会话元数据
- 会话ID: 01_文件解析器实现
- 会话类型: 核心组件开发
- 复杂度级别: 非复杂
- 当前交互次数: 0/5
- 会话状态: 进行中

## 任务背景
基于第一阶段基础框架，实现第二阶段核心功能模块。本提示词专注于实现智能文件类型识别和路径解析功能。

## 本次任务
请完成以下具体任务：
1. 创建 `core/file_resolver.py` 文件
2. 实现文件类型分析功能
3. 实现路径解析功能
4. 实现编码检测功能
5. 创建单元测试文件

## 输入资料
- 项目根目录：`LAD_md_ed2/local_markdown_viewer/`
- 第一阶段基础框架已建立
- 配置文件：`config/file_types.json`（如果存在）
- 工具模块：`utils/config_manager.py`

## 技术要求
1. **文件类型分析**：
   - 支持扩展名识别
   - 支持文件头内容分析
   - 支持MIME类型检测
   - 返回标准化的文件类型标识

2. **路径解析功能**：
   - 支持绝对路径和相对路径
   - 支持路径规范化
   - 支持路径有效性验证
   - 处理跨平台路径兼容性

3. **编码检测功能**：
   - 使用chardet库进行智能编码检测
   - 支持UTF-8、GBK、Latin-1等常见编码
   - 提供编码检测置信度
   - 处理编码检测失败的情况

4. **错误处理**：
   - 文件不存在时的处理
   - 权限不足时的处理
   - 编码检测失败时的处理
   - 路径无效时的处理

## 输出要求
1. **核心文件**：`core/file_resolver.py`
   - 包含FileResolver类
   - 实现所有核心方法
   - 包含完整的错误处理
   - 代码行数不超过300行

2. **测试文件**：`tests/test_file_resolver.py`
   - 包含基本功能测试
   - 包含错误情况测试
   - 包含边界条件测试
   - 代码行数不超过200行

3. **输出文件**：`outputs/01_文件解析器实现结果.md`
   - 记录实现过程
   - 记录关键设计决策
   - 记录测试结果
   - 记录下一步需要的资料

## 预设追问计划
1. 关于文件类型识别的深度追问：如何优化识别准确率？
2. 关于路径解析的完整性追问：是否考虑了所有边界情况？
3. 关于编码检测的质量提升追问：如何提高检测的可靠性？

## 下一步准备
请在实现完成后，提供一个标题为"【文件解析器实现结果-用于Markdown渲染器实现】"的部分，包含：
1. FileResolver类的完整接口定义
2. 支持的文件类型列表
3. 编码检测支持列表
4. 已知的限制和注意事项
5. 测试覆盖情况

这些信息将用于下一步的Markdown渲染器实现，请确保信息准确和完整。

## 容错机制
- 如果配置文件不存在，使用默认配置
- 如果chardet库不可用，使用基本的编码检测方法
- 如果测试失败，提供详细的错误信息和修复建议
- 如果实现过程中遇到技术难题，记录问题并提供替代方案

## 质量要求
- 代码必须通过基本语法检查
- 所有公共方法必须有文档字符串
- 错误处理必须完整且用户友好
- 测试覆盖率不低于80%

## 性能指标
- 文件解析时间 < 100ms（普通文件）
- 编码检测时间 < 200ms
- 内存使用 < 50MB
- 支持文件大小 < 100MB

## 质量检查点
- [ ] 代码语法检查通过
- [ ] 所有公共方法有文档字符串
- [ ] 错误处理覆盖所有异常情况
- [ ] 单元测试覆盖率 >= 80%
- [ ] 性能指标满足要求
- [ ] 输出文件格式正确 