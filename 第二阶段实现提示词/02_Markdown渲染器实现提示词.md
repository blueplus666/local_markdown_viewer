# 第二阶段核心功能实现 - 提示词2：Markdown渲染器实现

[⏰ 时区时间：YYYY-MM-DD HH:mm]

## 会话元数据
- 前序会话ID: 01_文件解析器实现
- 会话ID: 02_Markdown渲染器实现
- 会话类型: 组件集成
- 复杂度级别: 非复杂
- 当前交互次数: 0/5
- 会话状态: 进行中

## 前序数据摘要
基于前一个提示词的实现结果，我们需要以下信息：
1. FileResolver类的完整接口定义
2. 支持的文件类型列表
3. 编码检测支持列表
4. 已知的限制和注意事项
5. 测试覆盖情况

**注意**：如果前一个提示词执行失败或未提供完整资料，请使用以下测试数据：
```
【测试数据-文件解析器接口】
FileResolver类接口：
- resolve_file(file_path, base_path=None): 解析文件路径
- analyze_file_type(file_path): 分析文件类型
- detect_encoding(file_path): 检测文件编码
- get_file_info(file_path): 获取文件信息

支持的文件类型：['md', 'markdown', 'txt', 'py', 'js', 'html', 'css', 'json']
编码检测支持：['utf-8', 'gbk', 'latin-1', 'ascii']
```

## 本次任务
基于上述数据，请完成以下分析：
1. 创建 `core/markdown_renderer.py` 文件
2. 集成markdown_processor.py组件
3. 实现渲染接口
4. 测试渲染功能
5. 错误处理完善

## 分析要求
1. 充分利用前序数据作为基础
2. 重点关注markdown_processor.py的集成方式
3. 解决以下关键问题：
   - 如何安全导入markdown_processor模块
   - 如何处理渲染过程中的异常
   - 如何优化渲染性能
   - 如何支持自定义渲染选项

## 输入资料
- 项目根目录：`LAD_md_ed2/local_markdown_viewer/`
- markdown_processor模块：`../lad_markdown_viewer/markdown_processor.py`
- 前一个提示词的输出：`outputs/01_文件解析器实现结果.md`
- 工具模块：`utils/config_manager.py`

## 技术要求
1. **模块集成**：
   - 安全导入markdown_processor模块
   - 处理模块不存在的情况
   - 提供降级方案

2. **渲染接口**：
   - 提供render(markdown_content)方法
   - 提供render_file(file_path)方法
   - 支持自定义渲染选项
   - 返回标准化的HTML输出

3. **错误处理**：
   - 处理markdown语法错误
   - 处理文件读取错误
   - 处理模块导入错误
   - 提供用户友好的错误信息

4. **性能优化**：
   - 实现渲染缓存机制
   - 支持异步渲染
   - 优化大文件渲染性能

## 输出要求
1. **核心文件**：`core/markdown_renderer.py`
   - 包含MarkdownRenderer类
   - 实现所有核心方法
   - 包含完整的错误处理
   - 代码行数不超过250行

2. **测试文件**：`tests/test_markdown_renderer.py`
   - 包含基本渲染测试
   - 包含错误情况测试
   - 包含性能测试
   - 代码行数不超过150行

3. **输出文件**：`outputs/02_Markdown渲染器实现结果.md`
   - 记录实现过程
   - 记录集成方式
   - 记录测试结果
   - 记录下一步需要的资料

## 预设追问计划
1. 关于模块集成的深度追问：如何确保跨平台兼容性？
2. 关于渲染性能的完整性追问：如何优化大文件渲染？
3. 关于错误处理的质量提升追问：如何提供更好的用户体验？

## 下一步准备
请在分析完成后，提供一个标题为"【Markdown渲染器实现结果-用于内容预览器实现】"的部分，包含：
1. MarkdownRenderer类的完整接口定义
2. 支持的渲染选项列表
3. 性能优化措施
4. 已知的限制和注意事项
5. 测试覆盖情况

这些发现将直接用于下一步的内容预览器实现，请确保信息的相关性和实用性。

## 容错机制
- 如果markdown_processor模块不可用，提供基本的markdown渲染功能
- 如果前一个提示词的输出不完整，使用测试数据
- 如果渲染失败，提供降级到纯文本显示
- 如果性能测试失败，提供优化建议

## 错误恢复机制
1. **模块导入失败**：
   - 尝试使用备用markdown库
   - 提供基本的HTML转换功能
   - 记录错误日志并继续执行

2. **渲染失败**：
   - 降级到纯文本显示
   - 保留原始markdown内容
   - 提供错误信息给用户

3. **性能问题**：
   - 启用缓存机制
   - 限制渲染文件大小
   - 提供异步渲染选项

## 性能指标
- 渲染响应时间 < 500ms（普通markdown文件）
- 大文件渲染时间 < 2秒
- 内存使用 < 100MB
- 支持文件大小 < 10MB

## 质量检查点
- [ ] 模块集成成功
- [ ] 渲染功能正常
- [ ] 错误处理完善
- [ ] 性能指标满足要求
- [ ] 降级方案可用 