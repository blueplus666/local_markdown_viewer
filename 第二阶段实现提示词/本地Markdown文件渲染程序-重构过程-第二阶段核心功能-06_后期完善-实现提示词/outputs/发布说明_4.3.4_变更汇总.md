# 4.3.4 发布说明（变更汇总）

## 范围
- 方案C（混合方案）收尾：将 outputs 中产物迁入主项目目录，形成稳定包路径
- 4.3.4 质量保证与部署实施：计划、报告、检查清单、回滚方案、部署样例配置与聚合门禁

## 主要变更
- 代码迁移与收敛：
  - 新增目录与文件：
    - `integration/system_integration_coordinator.py`
    - `integration/link_processor_integration_preparer.py`
    - `monitoring/monitoring_system_deployer.py`
    - `benchmarks/performance_benchmark_tester.py`
  - `main.py`：读取 `config/lad_integration.json`，直接导入新模块并异步执行（不阻塞UI）
  - `bridge`：内部依赖改为稳定包路径，移除对 outputs 动态 sys.path 注入
- 监控与配置：
  - 统一监控输出到 `metrics/` 根目录
  - `lad_integration.json` 增加 `retention_days`，桥接读取覆盖
- QA 与报告：
  - 新增 `tests/test_qa_minimal.py`（最小门禁）
  - 新增 `tests/test_qa_all.py`（聚合门禁，强制UTF-8，编码防护）
  - 新增 `outputs/4.3.4-质量保证与部署实施计划.md`
  - 新增并回填 `outputs/方案4.3.4-质量保证与部署实施报告.md`
  - 新增 `outputs/qa_pre_deploy_checklist.md`、`outputs/rollback_plan_and_drills.md`
- 部署样例：
  - 新增 `outputs/deploy/deploy_config.sample.json`、`outputs/deploy/README.md`
  - CI建议：`PYTHONUTF8=1`、`PYTHONIOENCODING=utf-8`

## 验证结果
- 聚合测试 3 passed（约 113s），编码问题已修复
- `integration_test_report.json` / `validation_report.json` 成功率 100%

## 影响与回滚
- 默认开关关闭；开启后可随时关停回滚
- 回滚按 `outputs/rollback_plan_and_drills.md` 执行

## 下一步
- 将聚合门禁加入 CI 默认任务
- 生成正式部署配置并上线

## CHANGELOG（摘要）
- feat: integrate SystemIntegrationCoordinator/MonitoringSystemDeployer/BenchmarkTester into project tree
- feat: main.py loads lad_integration.json; async optional integration & monitoring
- feat: unify monitoring outputs to metrics/; add retention_days config
- feat: add QA minimal and aggregator tests with UTF-8 enforcement
- docs: add 4.3.4 plan/report, pre-deploy checklist, rollback plan
- docs: add deploy_config.sample.json and README with CI UTF-8 tips
- fix: Windows console GBK encoding issues in tests (subprocess UTF-8 + errors=replace)